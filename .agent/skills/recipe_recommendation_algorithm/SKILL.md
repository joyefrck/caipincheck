---
name: èœè°±æ¨èç®—æ³•
description: åŸºäºç”¨æˆ·ç”»åƒçš„å¤šç»´åº¦åŠ æƒè¯„åˆ†æ¨èç®—æ³•ï¼Œç”¨äºæ™ºèƒ½èœè°±æ¨èç³»ç»Ÿ
---

# èœè°±æ¨èç®—æ³• Skill

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªç”¨äºæ™ºèƒ½èœè°±æ¨èçš„ç®—æ³•æ¡†æ¶ï¼Œé‡‡ç”¨**åŸºäºç”¨æˆ·ç”»åƒçš„å¤šç»´åº¦åŠ æƒè¯„åˆ†**ï¼Œç»“åˆ**å¤šæ ·æ€§çº¦æŸ**å’Œ**æ—¶é—´å»é‡ç­–ç•¥**ï¼Œä¸ºç”¨æˆ·ç”Ÿæˆä¸ªæ€§åŒ–ä¸”è¥å…»å‡è¡¡çš„èœè°±ç»„åˆã€‚

## æ ¸å¿ƒç‰¹æ€§

- âœ… **ä¸ªæ€§åŒ–** - æ ¹æ®ç”¨æˆ·åå¥½ç²¾å‡†æ¨è
- âœ… **å¤šæ ·æ€§** - é¿å…é£Ÿæã€çƒ¹é¥ªæ–¹æ³•ã€èœç³»é‡å¤
- âœ… **è¥å…»å‡è¡¡** - ä¿è¯æ¨èèœå“çš„è¥å…»äº’è¡¥
- âœ… **æ–°é²œæ„Ÿ** - 7å¤©å†…ä¸é‡å¤æ¨è
- âœ… **å®¹é”™æ€§** - å€™é€‰æ± ä¸è¶³æ—¶çš„é™çº§ç­–ç•¥

---

## ç®—æ³•æµç¨‹

```
1. è·å–ç”¨æˆ·ç”»åƒï¼ˆèœç³»ã€å£å‘³ã€é£Ÿæã€çƒ¹é¥ªæ–¹æ³•ã€è¥å…»åå¥½æƒé‡ï¼‰
2. è¿‡æ»¤7å¤©å†…å†å²è®°å½• + ç”¨æˆ·æ’é™¤åˆ—è¡¨
3. å¯¹æ‰€æœ‰å€™é€‰èœè°±è¿›è¡Œå¤šç»´åº¦è¯„åˆ†
4. æŒ‰è¯„åˆ†æ’åº
5. åº”ç”¨å¤šæ ·æ€§çº¦æŸç­›é€‰ï¼ˆé£Ÿæã€çƒ¹é¥ªæ–¹æ³•ã€èœç³»ï¼‰
6. å¦‚æœå€™é€‰ä¸è¶³ï¼Œæ”¾å®½çº¦æŸç»§ç»­ç­›é€‰
7. æ ¼å¼åŒ–å¹¶è¿”å›æ¨èç»“æœ
```

---

## å¤šç»´åº¦è¯„åˆ†å…¬å¼

å¯¹äºæ¯é“å€™é€‰èœè°±ï¼Œè®¡ç®—ç»¼åˆè¯„åˆ†ï¼š

```
æ€»åˆ† = èœç³»åˆ† Ã— 2.0 + å£å‘³åˆ† Ã— 1.5 + çƒ¹é¥ªæ–¹æ³•åˆ† Ã— 1.2 + è¥å…»åˆ† Ã— 1.0 + é£Ÿæåˆ† Ã— 1.0
```

### è¯„åˆ†ç»´åº¦è¯´æ˜

| ç»´åº¦ | æƒé‡ç³»æ•° | è®¡ç®—æ–¹å¼ | è®¾è®¡ç†ç”± |
|------|---------|---------|---------|
| èœç³» | 2.0 | `ç”¨æˆ·èœç³»æƒé‡[èœè°±èœç³»] Ã— 2.0` | èœç³»åå¥½æœ€ç¨³å®šï¼Œæ˜¯é€‰æ‹©é¦–è¦å› ç´  |
| å£å‘³ | 1.5 | `Î£(ç”¨æˆ·å£å‘³æƒé‡[æ ‡ç­¾] Ã— 1.5)` | å£å‘³æ˜¯æ ¸å¿ƒä½“éªŒï¼Œä½†å¯èƒ½è·¨èœç³» |
| çƒ¹é¥ªæ–¹æ³• | 1.2 | `Î£(ç”¨æˆ·çƒ¹é¥ªæ–¹æ³•æƒé‡[æ–¹æ³•] Ã— 1.2)` | å½±å“å£æ„Ÿå’Œå¥åº·ï¼Œé‡è¦æ€§ä¸­ç­‰ |
| è¥å…» | 1.0 | `Î£(ç”¨æˆ·è¥å…»æƒé‡[æ ‡ç­¾] Ã— 1.0)` | é•¿æœŸå¥åº·è€ƒé‡ï¼ŒåŸºç¡€æƒé‡ |
| é£Ÿæ | 1.0 | `Î£(ç”¨æˆ·é£Ÿææƒé‡[é£Ÿæ] Ã— 1.0)` | åŸºç¡€æƒé‡ï¼ˆç”¨æˆ·å¯èƒ½ä¸æ¸…æ¥šå…·ä½“åå¥½ï¼‰ |

### ç¤ºä¾‹è®¡ç®—

**ç”¨æˆ·ç”»åƒ**:
- å·èœæƒé‡: 0.8
- è¾£å‘³æƒé‡: 0.7
- å’¸å‘³æƒé‡: 0.6

**èœè°±**: å®«ä¿é¸¡ä¸ï¼ˆå·èœï¼Œè¾£+å’¸ï¼‰

```
èœç³»åˆ† = 0.8 Ã— 2.0 = 1.6
å£å‘³åˆ† = (0.7 + 0.6) Ã— 1.5 = 1.95
æ€»åˆ† = 1.6 + 1.95 + ... = é«˜è¯„åˆ†
```

---

## å¤šæ ·æ€§çº¦æŸæœºåˆ¶

### ä¸‰é‡çº¦æŸ

#### 1. é£Ÿæå¤šæ ·æ€§
```javascript
// é¿å…"é¸¡è‚‰å¥—é¤"ï¼ˆ3é“èœéƒ½æ˜¯é¸¡è‚‰ï¼‰
if (èœè°±ä¸»é£Ÿæ(å‰2ä¸ª) âˆ© å·²é€‰èœå“ä¸»é£Ÿæ â‰  âˆ…) {
  è·³è¿‡è¯¥èœè°±
}
```

#### 2. çƒ¹é¥ªæ–¹æ³•å¤šæ ·æ€§
```javascript
// é¿å…"æ²¹ç‚¸å¥—é¤"ï¼ˆ3é“èœéƒ½æ˜¯æ²¹ç‚¸ï¼‰
if (èœè°±æ‰€æœ‰çƒ¹é¥ªæ–¹æ³• âŠ† å·²é€‰çƒ¹é¥ªæ–¹æ³•é›†åˆ) {
  è·³è¿‡è¯¥èœè°±
}
```

#### 3. èœç³»å¤šæ ·æ€§
```javascript
// é¼“åŠ±æ¢ç´¢ä¸åŒèœç³»ï¼ˆä½†å…è®¸æœ€å¤š2é“åŒèœç³»ï¼‰
if (åŒèœç³»å·²é€‰èœå“æ•°é‡ >= 2) {
  è·³è¿‡è¯¥èœè°±
}
```

### é™çº§ç­–ç•¥

å½“å¤šæ ·æ€§çº¦æŸè¿‡ä¸¥ï¼Œå¯¼è‡´é€‰å‡ºçš„èœå“æ•°é‡ä¸è¶³æ—¶ï¼š

```javascript
if (selected_recipes.length < target_count) {
  console.log("âš ï¸  æ”¾å®½å¤šæ ·æ€§é™åˆ¶");
  // å¿½ç•¥å¤šæ ·æ€§çº¦æŸï¼Œç›´æ¥æŒ‰è¯„åˆ†é€‰æ‹©
  for (candidate in sorted_candidates) {
    if (!å·²é€‰æ‹©(candidate)) {
      selected_recipes.push(candidate);
    }
  }
}
```

---

## 7å¤©ä¸é‡å¤é€»è¾‘

```javascript
const sevenDaysAgo = Date.now() - 7 * 24 * 60 * 60 * 1000;
const recentHistory = await db.query(`
  SELECT id FROM history 
  WHERE created_at > ? 
`, [sevenDaysAgo]);

const excludeIds = [...recentHistory.map(r => r.id), ...userProvidedExcludeIds];

const candidates = await db.query(`
  SELECT * FROM base_recipes 
  WHERE id NOT IN (${excludeIds.join(',')})
`);
```

**è®¾è®¡è€ƒé‡**:
- æ—¶é—´çª—å£: 7å¤©ï¼ˆå¯é…ç½®ï¼‰
- æ’é™¤æ¥æº: å†å²è®°å½• + ç”¨æˆ·æ‰‹åŠ¨æ’é™¤
- ç›®çš„: ä¿è¯æ¯å‘¨éƒ½æœ‰æ–°é²œä½“éªŒ

---

## ç”¨æˆ·ç”»åƒæ›´æ–°æœºåˆ¶

### åé¦ˆæƒé‡è°ƒæ•´

```javascript
// å–œæ¬¢: +0.05ï¼Œä¸å–œæ¬¢: -0.03
const delta = feedbackType === 'like' ? 0.05 : -0.03;
const minWeight = 0.1;
const maxWeight = 1.0;

// æ›´æ–°å„ç»´åº¦æƒé‡
profile.cuisineWeights[cuisine] = clamp(
  profile.cuisineWeights[cuisine] + delta,
  minWeight,
  maxWeight
);
```

### å¯¹è¯å¼åå¥½è°ƒæ•´

å½“ç”¨æˆ·è¾“å…¥éç‰¹å®šèœåï¼ˆå¦‚"æˆ‘å–œæ¬¢åƒè¾£çš„"ï¼‰æ—¶ï¼š

1. **è§£æ**: AI è¯†åˆ«å¯¹è¯ä¸­çš„å‘³å‹ã€èœç³»è°ƒæ•´æ„å›¾
2. **åº”ç”¨**: ç«‹å³æ›´æ–°æ•°æ®åº“ä¸­çš„ç›¸åº”æƒé‡
3. **é‡å®šå‘**: å°†åå¥½æè¿°æå–ä¸ºå…³é”®è¯ä½œä¸ºæ¨èéœ€æ±‚
4. **æ³¨å…¥**: åœ¨è¿”å›ç»“æœä¸­æ³¨å…¥åå¥½æ›´æ–°æç¤º

**ç¤ºä¾‹**:
```
ç”¨æˆ·: "æˆ‘å–œæ¬¢åƒå·èœ"
ç³»ç»Ÿ: æ›´æ–°å·èœæƒé‡ -> æ¨èå·èœ -> æ˜¾ç¤º"âœ… å·²å¢åŠ å·èœåå¥½"
```

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. çŸ­è¯­é€Ÿé€š (Fast Pass)
**é—®é¢˜**: ç®€å•æŸ¥è¯¢ä¹Ÿè°ƒç”¨AIï¼Œå»¶è¿Ÿ1-3ç§’  
**æ–¹æ¡ˆ**: æ­£åˆ™é¢„æ£€ï¼Œè·³è¿‡AI
```javascript
if (QueryLength < 10 && !HasPreferenceKeywords) {
  // ç›´æ¥æœ¬åœ°æŸ¥è¯¢ï¼Œå“åº”æ—¶é—´ < 50ms
}
```

### 2. æ™ºèƒ½è¡¥ä½ (Smart Filling)
**é—®é¢˜**: æœ¬åœ°åªåŒ¹é…1é“èœï¼Œæ— æ³•å‡‘é½å¥—é¤  
**æ–¹æ¡ˆ**: ä¿ç•™æ ¸å¿ƒåŒ¹é… + éšæœºè¡¥ä½
```javascript
if (matched.length < target) {
  // ä»æœ¬åœ°åº“éšæœºé€‰å–ä¸é‡å¤èœå“è¡¥ä½
  å¡«å……è‡³ç›®æ ‡æ•°é‡
}
```

### 3. ç²¾å‡†åŒ¹é…ä¼˜å…ˆ
**é—®é¢˜**: æ¨¡ç³ŠåŒ¹é…å¯¼è‡´ç»“æœä¸å‡†  
**æ–¹æ¡ˆ**: è°ƒæ•´SQLæ’åºæƒé‡
```sql
ORDER BY 
  CASE 
    WHEN title = ? THEN 3        -- å®Œå…¨åŒ¹é…
    WHEN title LIKE ? THEN 2     -- åŒ…å«åŒ¹é…
    ELSE 1                        -- å…¶ä»–
  END DESC
```

### 4. è¤ç´ å¹³è¡¡çº¦æŸ
**é—®é¢˜**: æ¨èå…¨è‚‰æˆ–å…¨ç´   
**æ–¹æ¡ˆ**: æˆåˆ†æ£€æµ‹ + è¡¥ä½åå‘
```javascript
if (å·²é€‰æœ‰è‚‰èœ) {
  // åç»­ç©ºä½å¼ºåˆ¶ä»ç´ èœæˆ–æ±¤ç¾¹ä¸­é€‰æ‹©
  è¡¥ä½ä¼˜å…ˆçº§: ç´ èœ > æ±¤ç¾¹ > å…¶ä»–
}
```

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æ™ºèƒ½æ¨è
```javascript
// APIè°ƒç”¨
POST /api/recommend
{
  "userId": "peter_yong",
  "diners": 3,
  "excludeRecipeIds": []
}

// è¿”å›
{
  "title": "è”¡å¤§å¨ç²¾é€‰å¥—é¤Â·å®«ä¿é¸¡ä¸ç­‰3é“",
  "dishes": [...],
  "nutritionInfo": "ğŸ¯ è¤ç´ å‡è¡¡ï¼Œè¥å…»å…¨é¢..."
}
```

### åœºæ™¯2: å…³é”®è¯æœç´¢
```javascript
// ç”¨æˆ·è¾“å…¥: "å°ç‚’è‚‰"
// ç³»ç»Ÿ: 1. æœ¬åœ°ç²¾å‡†åŒ¹é… 2. æ™ºèƒ½è¡¥ä½ 3. è¿”å›å¥—é¤
```

### åœºæ™¯3: åå¥½å­¦ä¹ 
```javascript
// ç”¨æˆ·ç‚¹å‡»"å–œæ¬¢"
await recordFeedback('peter_yong', recipeId, 'like', recipeData);
// ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ç”¨æˆ·ç”»åƒæƒé‡
```

---

## è°ƒä¼˜å»ºè®®

### è°ƒæ•´è¯„åˆ†æƒé‡
```javascript
// é™ä½èœç³»æƒé‡ï¼ˆå¦‚æœæ¨èè¿‡äºé›†ä¸­ï¼‰
const cuisineScore = profile.cuisineWeights[cuisine] * 1.5; // ä»2.0é™åˆ°1.5
```

### è°ƒæ•´å¤šæ ·æ€§é˜ˆå€¼
```javascript
// æ”¾å®½èœç³»é‡å¤é™åˆ¶
const hasCuisineConflict = cuisineCount >= 3; // ä»2æ”¹ä¸º3
```

### è°ƒæ•´å­¦ä¹ é€Ÿç‡
```javascript
// é™ä½å•æ¬¡åé¦ˆå½±å“
const delta = feedbackType === 'like' ? 0.03 : -0.01; // ä»0.05/-0.03é™ä½
```

---

## æµ‹è¯•ç”¨ä¾‹

### æ­£å¸¸åœºæ™¯
- **è¾“å…¥**: ç”¨æˆ·å–œæ¬¢å·èœï¼ˆæƒé‡0.8ï¼‰ï¼Œ2äººç”¨é¤
- **é¢„æœŸ**: æ¨è2é“å·èœç›¸å…³èœå“ï¼Œé£Ÿæå’Œçƒ¹é¥ªæ–¹æ³•å¤šæ ·

### è¾¹ç•Œåœºæ™¯
- **è¾“å…¥**: å€™é€‰æ± åªæœ‰5é“èœï¼Œéœ€è¦æ¨è3é“
- **é¢„æœŸ**: æˆåŠŸæ¨è3é“ï¼ˆå¯èƒ½è§¦å‘æ”¾å®½é™åˆ¶ï¼‰

### å¼‚å¸¸åœºæ™¯
- **è¾“å…¥**: å€™é€‰æ± ä¸ºç©º
- **é¢„æœŸ**: è¿”å›é”™è¯¯"å€™é€‰èœè°±æ± ä¸ºç©ºï¼Œè¯·æ·»åŠ æ›´å¤šåŸºç¡€èœè°±"

---

## æ•°æ®ç»“æ„

### ç”¨æˆ·ç”»åƒ
```typescript
interface UserProfile {
  userId: string;
  tasteWeights: Record<string, number>;        // å£å‘³æƒé‡
  cuisineWeights: Record<string, number>;      // èœç³»æƒé‡
  ingredientWeights: Record<string, number>;   // é£Ÿææƒé‡
  cookingMethodWeights: Record<string, number>; // çƒ¹é¥ªæ–¹æ³•æƒé‡
  nutritionWeights: Record<string, number>;    // è¥å…»æƒé‡
  updatedAt: number;
}
```

### èœè°±ç»“æ„
```typescript
interface BaseRecipe {
  id: string;
  title: string;
  cuisine_type: string;
  ingredients: string; // JSON
  steps: string;       // JSON
  tags: string;        // JSON
  taste_tags: string;  // JSON
  cooking_methods: string; // JSON
  nutrition_tags: string;  // JSON
}
```

---

## å®ç°å‚è€ƒ

å®Œæ•´å®ç°è¯·å‚è€ƒé¡¹ç›®æ–‡ä»¶:
- æ¨èAPI: `server/index.js` (ç¬¬563-873è¡Œ)
- è¥å…»ä¿¡æ¯ç”Ÿæˆ: `server/index.js` (ç¬¬27-135è¡Œ)
- ç”¨æˆ·ç”»åƒæ›´æ–°: `server/index.js` (ç¬¬876-989è¡Œ)
- è¯¦ç»†ç®—æ³•æ–‡æ¡£: `recommendation_algorithm.md`

---

## è®¸å¯è¯

æœ¬ç®—æ³•æ¡†æ¶ä¸ºè”¡å“æ£€é¡¹ç›®ä¸“ç”¨ï¼Œç‰ˆæƒæ‰€æœ‰ Â© 2025
