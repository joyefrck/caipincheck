# � 1Panel + GitHub 持续部署与更新指南

当您的代码推送到 GitHub 后，按照以下步骤在 1Panel 生产环境进行更新：

## 1. 手动更新流程 (最稳妥)

### 第一步：同步代码
前往服务器项目根目录（可以通过 1Panel 的“终端”或 SSH）：
```bash
git pull origin main
```
*注：如果您的分支不是 main，请替换为对应的分支名。*

### 第二步：更新依赖与重新编译 (关键)
代码更新后，前端代码需要重新构建，后端才能生效。
```bash
# 安装可能新增的依赖
npm install

# 重新构建前端静态文件
npm run build
```

### 第三步：重启项目
在 1Panel 面板中：
1. 进入 **【容器】** 或 **【运行环境】**（取决于您如何创建的项目）。
2. 找到您的 Node.js 项目。
3. 点击 **【重启】** 按钮。

---

## 2. 自动化更新脚本 (推荐)

为了省去每次敲命令的麻烦，您可以在项目根目录创建一个 `deploy.sh`：

```bash
#!/bin/bash
echo "开始自动化部署..."

# 1. 拉取代码
git pull origin main

# 2. 安装依赖
npm install

# 3. 编译前端
npm run build

# 4. 重启应用 (如果您使用 PM2)
pm2 restart caipincheck

# 或者如果您在 1Panel 没使用 PM2，可以在面板手动点一次重启
echo "部署完成！请在 1Panel 面板重启项目以生效。"
```

**使用方法：**
1. 赋予执行权限：`chmod +x deploy.sh`
2. 每次想更新时运行：`./deploy.sh`

---

## 3. 注意事项
- **数据库文件**：执行 `git pull` 时，请确保您的 `.gitignore` 中包含了 `food-check.db`。**千万不要把生产环境的数据库给覆盖了/抹掉了！**
- **环境变量**：如果您在本地 `.env` 增加了新的变量，记得在 1Panel 项目配置中同步添加。
- **构建内存**：如果服务器内存较小（如 1G），执行 `npm run build` 时可能会因为内存不足而失败。建议将 `dist` 文件夹也一并 git 提交，或者增加虚拟内存。
